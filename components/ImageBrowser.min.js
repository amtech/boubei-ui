"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,i=!1,s=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(e){i=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(e){var t=function(){this.images=[],this.current=0,this.show=!1,this._dom,this.dom$imageName,this.dom$page,this.init()};function i(e,t){var r=window.getComputedStyle(e,null).getPropertyValue("transform"),a=r.split("(")[1].split(")")[0].split(","),i=_slicedToArray(a,2),s=i[0],n=i[1],o=Math.round(Math.atan2(n,s)*(180/Math.PI));e.style="-webkit-transform:rotate("+(o+t)+"deg);transform:rotate("+(o+t)+"deg)"}function n(e){var t=e.dom,r=e.offset;t.scrollLeft+=r}t.prototype={constructor:t,mount:function(e){return e.appendChild(this._dom),this},showOnClick:function(e){if(null!=e){for(var t=e.getElementsByTagName("a"),r=[],a=0,i=t[a];void 0!==i;i=t[++a]){var s=i.getAttribute("href"),n=i.innerText;i.setAttribute("href","javascript:void(0);"),i.dataset.url=s,i.dataset.index=a,r.push({url:s,text:n})}this.insertImages(r),this.images=r,e.addEventListener("click",function(e){var r=this,t=e||window.event,a=t.target||t.srcElement;if("a"===a.nodeName.toLocaleLowerCase()){this.toggleClose();var i=+a.dataset.index;if([(this.current=i)-1,i,i+1].forEach(function(e){var t=r.images[e];t&&t.dom.setAttribute("src",t.url)}),this._dom.getElementsByClassName("image-browser__image-swiper")[0].scrollLeft=600*i,this.dom$imageName.innerText=this.images[i].text,this.dom$page.innerText=i+1+"/"+this.images.length,0==i){var s=this._dom.getElementsByClassName("image-browser__btn_arrow_back")[0];s.classList.add("image-browser__btn_disable")}if(i==this.images.length-1){var n=this._dom.getElementsByClassName("image-browser__btn_arrow_forward")[0];n.classList.add("image-browser__btn_disable")}}}.bind(this),!1)}},toggleClose:function(){var e=this._dom;if(this.show){this.show=!1;var t=e.getElementsByClassName("image-browser__image-swiper")[0];t.scrollLeft=0;var r=e.getElementsByClassName("image-browser__btn_arrow_back")[0];r.classList.remove("image-browser__btn_disable");var a=e.getElementsByClassName("image-browser__btn_arrow_forward")[0];a.classList.remove("image-browser__btn_disable"),e.classList.remove("image-browser__show"),this.current=0}else this.show=!0,e.classList.add("image-browser__show")},lazyLoadImage:function(e){var t=this.images[e];if(null!=t){var r=t.url,a=t.dom;null===a.getAttribute("src")&&a.setAttribute("src",r)}},init:function(){var e=this.create("div","image-browser"),t=this.createToolbar(),r=this.createImageNav(),a=this.createFooter();e.appendChild(t),e.appendChild(r),e.appendChild(a),this._dom=e,this.mount(document.body);var i=document.getElementsByClassName("ext")[0];this.showOnClick(i)},create:function(e,t){var r=document.createElement(e);return r.className=t,r},createToolbar:function(){var e=this.create("div","image-browser__row image-browser__toolbar"),t=this.create("button","image-browser__btn image-browser__rotate-btn");t.appendChild(document.createTextNode("向左旋转"));var r=this.create("button","image-browser__btn image-browser__rotate-btn");r.appendChild(document.createTextNode("向右旋转"));var a=this.create("button","image-browser__btn image-browser__close-btn ion-ios-close-circle-outline");return e.appendChild(t),e.appendChild(r),e.appendChild(a),t.onclick=function(){i(this.images[this.current].dom,-90)}.bind(this),r.onclick=function(){i(this.images[this.current].dom,90)}.bind(this),a.onclick=this.toggleClose.bind(this),e},createFooter:function(){var e=this.create("div","image-browser__row image-browser__footer"),t=this.create("div","image-browser__image-name");t.innerText="附件名称",this.dom$imageName=t;var r=this.create("div","image-browser__page");return r.innerText="0/0",this.dom$page=r,e.appendChild(t),e.appendChild(r),e},createImageNav:function(){var r=this,e=this.create("div","image-browser__row image-browser__image-nav"),t=this.create("div","image-browser__image-swiper"),a=function(e){var t=r.create("button","image-browser__btn image-browser__btn_arrow_"+e+" ion-ios-arrow-"+e);return t},i=a("back"),s=a("forward");return e.appendChild(i),e.appendChild(t),e.appendChild(s),i.onclick=function(){0!=r.current&&(s.classList.remove("image-browser__btn_disable"),n({dom:t,offset:-600}),r.current=r.current-1,r.dom$imageName.innerText=r.images[r.current].text,r.dom$page.innerText=r.current+1+"/"+r.images.length,r.lazyLoadImage(r.current-1),0==r.current&&i.classList.add("image-browser__btn_disable"))},s.onclick=function(){var e=r.images.length;r.current!=e-1&&(i.classList.remove("image-browser__btn_disable"),n({dom:t,offset:600}),r.current=r.current+1,r.dom$imageName.innerText=r.images[r.current].text,r.dom$page.innerText=r.current+1+"/"+e,r.lazyLoadImage(r.current+1),r.current==e-1&&s.classList.add("image-browser__btn_disable"))},e},createImage:function(e){var t=e.src,r=e.index,a=this.create("img","image-browser__image");return a.setAttribute("alt",t),a.style="-webkit-transform:rotate(0);transform:rotate(0)",a.dataset.index=r,a},insertImages:function(e){var i=this,s=this._dom.getElementsByClassName("image-browser__image-swiper")[0];e.forEach(function(e,t){var r=i.createImage({src:e.url,index:t}),a=i.create("div","image-browser__image-wrapper");a.style.left=600*t+"px",a.appendChild(r),s.appendChild(a),e.dom=r})}},e.init=function(){return new t}}(window.ImageBrowser={}),ImageBrowser.init();