"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,a=!1,s=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(a)throw s}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(e){var t=function(){this.images=[],this.current=0,this.show=!1,this._dom,this.dom$imageName,this.dom$page,this.init()};function s(e,t){var i=window.getComputedStyle(e,null).getPropertyValue("transform"),r=i.split("(")[1].split(")")[0].split(","),a=_slicedToArray(r,2),s=a[0],n=a[1],o=Math.round(Math.atan2(n,s)*(180/Math.PI));e.style="-webkit-transform:rotate("+(o+t)+"deg);transform:rotate("+(o+t)+"deg)"}function n(e){var t=e.dom,i=e.offset;t.scrollLeft+=i}t.prototype={constructor:t,mount:function(e){return e.appendChild(this._dom),this},showOnClick:function(e){for(var t=e.getElementsByTagName("a"),i=[],r=0,a=t[r];void 0!==a;a=t[++r]){var s=a.getAttribute("href"),n=a.innerText;a.setAttribute("href","javascript:void(0);"),a.dataset.url=s,a.dataset.index=r,i.push({url:s,text:n})}this.insertImages(i),this.images=i,e.addEventListener("click",function(e){var i=this,t=e||window.event,r=t.target||t.srcElement;if("a"===r.nodeName.toLocaleLowerCase()){this.toggleClose();var a=+r.dataset.index;[(this.current=a)-1,a,a+1].forEach(function(e){var t=i.images[e];t&&t.dom.setAttribute("src",t.url)}),this._dom.getElementsByClassName("image-browser__image-swiper")[0].scrollLeft=600*a,this.dom$imageName.innerText=this.images[a].text,this.dom$page.innerText=this.current+1+"/"+this.images.length}}.bind(this),!1)},toggleClose:function(){if(this.show){this.show=!1;var e=this._dom.getElementsByClassName("image-browser__image-swiper")[0];e.scrollLeft=0,this._dom.classList.remove("image-browser__show"),this.current=0}else this.show=!0,this._dom.classList.add("image-browser__show")},lazyLoadImage:function(e){var t=this.images[e],i=t.url,r=t.dom;null===r.getAttribute("src")&&r.setAttribute("src",i)},init:function(){var e=this.create("div","image-browser"),t=this.createToolbar(),i=this.createImageNav(),r=this.createFooter();e.appendChild(t),e.appendChild(i),e.appendChild(r),this._dom=e,this.mount(document.body),this.showOnClick(document.getElementsByClassName("ext")[0])},create:function(e,t){var i=document.createElement(e);return i.className=t,i},createToolbar:function(){var e=this.create("div","image-browser__row image-browser__toolbar"),t=this.create("button","image-browser__btn image-browser__rotate-btn");t.appendChild(document.createTextNode("向左旋转"));var i=this.create("button","image-browser__btn image-browser__rotate-btn");i.appendChild(document.createTextNode("向右旋转"));var r=this.create("button","image-browser__btn image-browser__close-btn"),a=this.create("i","image-browser__btn-icon ion-ios-close-circle-outline");return r.appendChild(a),e.appendChild(t),e.appendChild(i),e.appendChild(r),t.onclick=function(){s(this.images[this.current].dom,-90)}.bind(this),i.onclick=function(){s(this.images[this.current].dom,90)}.bind(this),r.onclick=this.toggleClose.bind(this),e},createFooter:function(){var e=this.create("div","image-browser__row image-browser__footer"),t=this.create("div","image-browser__image-name");t.innerText="附件名称",this.dom$imageName=t;var i=this.create("div","image-browser__page");return i.innerText="0/0",this.dom$page=i,e.appendChild(t),e.appendChild(i),e},createImageNav:function(){var r=this,e=this.create("div","image-browser__row image-browser__image-nav"),t=this.create("div","image-browser__image-swiper"),i=function(e){var t=r.create("button","image-browser__btn image-browser__"+e+"-btn"),i=r.create("i","image-browser__btn-icon ion-ios-arrow-"+e);return t.appendChild(i),t},a=i("back"),s=i("forward");return e.appendChild(a),e.appendChild(t),e.appendChild(s),a.onclick=function(){if(0!=this.current){n({dom:t,offset:-600});var e=this.images.length;this.current=(this.current+e-1)%e,this.lazyLoadImage((this.current+e-1)%e),this.dom$imageName.innerText=this.images[this.current].text,this.dom$page.innerText=this.current+1+"/"+this.images.length}else alert("没有图片了")}.bind(this),s.onclick=function(){var e=this.images.length;this.current!=e-1?(n({dom:t,offset:600}),this.current=(this.current+1)%e,this.lazyLoadImage((this.current+1)%e),this.dom$imageName.innerText=this.images[this.current].text,this.dom$page.innerText=this.current+1+"/"+this.images.length):alert("没有图片了")}.bind(this),e},createImage:function(e){var t=e.src,i=e.index,r=this.create("img","image-browser__image");return r.setAttribute("alt",t),r.style="-webkit-transform:rotate(0);transform:rotate(0)",r.dataset.index=i,r},insertImages:function(e){var a=this,s=this._dom.getElementsByClassName("image-browser__image-swiper")[0];e.forEach(function(e,t){var i=a.createImage({src:e.url,index:t}),r=a.create("div","image-browser__image-wrapper");r.style.left=600*t+"px",r.appendChild(i),s.appendChild(r),e.dom=i})}},e.init=function(){return new t}}(window.ImageBrowser={}),ImageBrowser.init();